var PGEdit_IE32_CLASSID="3DC4198F-C37E-4B88-81F4-B1B0BAAA74F8",PGEdit_IE32_CAB="",PGEdit_IE32_Version="1.0.0.2",PGEdit_IE32_EXE="JDeditIE.exe",PGEdit_IE64_CLASSID="3E19ED2C-C422-4D53-94D6-DC526554EDC1",PGEdit_IE64_CAB="",PGEdit_IE64_Version="1.0.0.2",PGEdit_IE64_EXE="JDeditX64.exe",PGEdit_FF="JDedit.exe",PGEdit_FF_VERSION="1.0.0.2",PGEdit_Update="0";navigator.userAgent.indexOf("MSIE")<0&&navigator.plugins.refresh(),function(a){a.pge=function(b){this.settings=a.extend(!0,{},a.pge.defaults,b),this.init()},a.extend(a.pge,{defaults:{pgePath:"./ocx/",pgeId:"",pgeEdittype:0,pgeEreg1:"",pgeEreg2:"",pgeMaxlength:12,pgeTabindex:2,pgeClass:"ocx_style",pgeInstallClass:"ocx_style",pgeOnkeydown:"",pgeFontName:"",pgeFontSize:"",tabCallback:"",pgeBackColor:"",pgeForeColor:""},prototype:{init:function(){this.pgeDownText="\u8bf7\u5237\u65b0\u9875\u9762\u6216\u5b89\u88c5\u5b89\u5168\u63a7\u4ef6",this.osBrowser=this.checkOsBrowser(),this.pgeVersion=this.getVersion(),this.isInstalled=this.checkInstall()},checkOsBrowser:function(){var a;return"Win32"==navigator.platform||"Windows"==navigator.platform?navigator.userAgent.indexOf("MSIE")>0||navigator.userAgent.indexOf("msie")>0||navigator.userAgent.indexOf("Trident")>0||navigator.userAgent.indexOf("trident")>0?navigator.userAgent.indexOf("ARM")>0?(a=9,this.pgeditIEExe=""):(a=1,this.pgeditIEClassid=PGEdit_IE32_CLASSID,this.pgeditIECab=PGEdit_IE32_CAB,this.pgeditIEExe=PGEdit_IE32_EXE):(a=2,this.pgeditFFExe=PGEdit_FF):"Win64"==navigator.platform&&(navigator.userAgent.indexOf("Windows NT 6.2")>0||navigator.userAgent.indexOf("windows nt 6.2")>0?(a=1,this.pgeditIEClassid=PGEdit_IE32_CLASSID,this.pgeditIECab=PGEdit_IE32_CAB,this.pgeditIEExe=PGEdit_IE32_EXE):navigator.userAgent.indexOf("MSIE")>0||navigator.userAgent.indexOf("msie")>0||navigator.userAgent.indexOf("Trident")>0||navigator.userAgent.indexOf("trident")>0?(a=3,this.pgeditIEClassid=PGEdit_IE64_CLASSID,this.pgeditIECab=PGEdit_IE64_CAB,this.pgeditIEExe=PGEdit_IE64_EXE):(a=2,this.pgeditFFExe=PGEdit_FF)),a},getpgeHtml:function(){if(1==this.osBrowser||3==this.osBrowser){var a='<span id="'+this.settings.pgeId+'_pge" style="display:none;"><OBJECT ID="'+this.settings.pgeId+'" CLASSID="CLSID:'+this.pgeditIEClassid+'" onkeydown="if(13==event.keyCode || 27==event.keyCode)'+this.settings.pgeOnkeydown+';" tabindex="'+this.settings.pgeTabindex+'" class="'+this.settings.pgeClass+'"><param name="edittype" value="'+this.settings.pgeEdittype+'"><param name="maxlength" value="'+this.settings.pgeMaxlength+'"><param name="input2" value="'+this.settings.pgeEreg1+'"><param name="input3" value="'+this.settings.pgeEreg2+'">';return void 0!=this.settings.pgeFontName&&""!=this.settings.pgeFontName&&(a+='<param name="FontName" value="'+this.settings.pgeFontName+'">'),void 0!=this.settings.pgeFontSize&&""!=this.settings.pgeFontSize&&(a+='<param name="FontSize" value="'+this.settings.pgeFontSize+'">'),a+="</OBJECT></span>",a+='<div id="'+this.settings.pgeId+'_down" class="'+this.settings.pgeInstallClass+'" style="text-align:center;display:none;"><a href="'+this.settings.pgePath+this.pgeditIEExe+'">'+this.pgeDownText+"</a></div>"}if(2==this.osBrowser){var a='<embed ID="'+this.settings.pgeId+'" input_10="false" maxlength="'+this.settings.pgeMaxlength+'" input_2="'+this.settings.pgeEreg1+'" input_3="'+this.settings.pgeEreg2+'" edittype="'+this.settings.pgeEdittype+'" type="application/jdedit" tabindex="'+this.settings.pgeTabindex+'" class="'+this.settings.pgeClass+'" ';return void 0!=this.settings.pgeOnkeydown&&""!=this.settings.pgeOnkeydown&&(a+=' input_1013="'+this.settings.pgeOnkeydown+'"'),void 0!=this.settings.tabCallback&&""!=this.settings.tabCallback&&(a+=" input_1009=\"document.getElementById('"+this.settings.tabCallback+"').focus()\""),void 0!=this.settings.pgeFontName&&""!=this.settings.pgeFontName&&(a+=' FontName="'+this.settings.pgeFontName+'"'),void 0!=this.settings.pgeFontSize&&""!=this.settings.pgeFontSize&&(a+=" FontSize="+Number(this.settings.pgeFontSize)),a+=" >"}return'<span id="'+this.settings.pgeId+'_down" class="'+this.settings.pgeInstallClass+'" style="text-align:center;">\u6682\u4e0d\u652f\u6301\u6b64\u6d4f\u89c8\u5668</span>'},getDownHtml:function(){return 1==this.osBrowser||3==this.osBrowser?'<span id="'+this.settings.pgeId+'_down" class="'+this.settings.pgeInstallClass+'" style="text-align:center;"><a href="'+this.settings.pgePath+this.pgeditIEExe+'">'+this.pgeDownText+"</a></span>":2==this.osBrowser?'<span id="'+this.settings.pgeId+'_down" class="'+this.settings.pgeInstallClass+'" style="text-align:center;"><a href="'+this.settings.pgePath+this.pgeditFFExe+'">'+this.pgeDownText+"</a></span>":'<span id="'+this.settings.pgeId+'_down" class="'+this.settings.pgeInstallClass+'" style="text-align:center;">\u6682\u4e0d\u652f\u6301\u6b64\u6d4f\u89c8\u5668</span>'},getLinkHtml:function(){return 1==this.osBrowser||3==this.osBrowser?this.pgeditIEExe:2==this.osBrowser?this.pgeditFFExe:"nonsupport"},load:function(){return this.checkInstall()?2==this.osBrowser&&this.checkUpdate()?(this.setDownText(),this.getDownHtml()):this.getpgeHtml():this.getDownHtml()},generate:function(){if(2==this.osBrowser){if(0==this.isInstalled)return document.write(this.getDownHtml());if(this.checkUpdate())return this.setDownText(),document.write(this.getDownHtml())}return document.write(this.getpgeHtml())},pwdclear:function(){if(this.checkInstall()){var a=document.getElementById(this.settings.pgeId);a.ClearSeCtrl()}},pwdSetSk:function(a){if(this.checkInstall())try{var b=document.getElementById(this.settings.pgeId);1==this.osBrowser||3==this.osBrowser?b.input1=a:2==this.osBrowser&&b.input(1,a)}catch(c){}},pwdResultHash:function(){var a="";if(this.checkInstall())try{var b=document.getElementById(this.settings.pgeId);1==this.osBrowser||3==this.osBrowser?a=b.output:2==this.osBrowser&&(b.package=5,a=b.output(7))}catch(c){a=""}else a="";return a},pwdResult:function(){var a="";if(this.checkInstall())try{var b=document.getElementById(this.settings.pgeId);1==this.osBrowser||3==this.osBrowser?a=b.output1:2==this.osBrowser&&(a=b.output(7))}catch(c){a=""}else a="";return a},machineNetwork:function(){var a="";if(this.checkInstall())try{var b=document.getElementById(this.settings.pgeId);1==this.osBrowser||3==this.osBrowser?a=b.GetIPMacList():2==this.osBrowser&&(b.package=0,a=b.output(9))}catch(c){a=""}else a="";return a},machineDisk:function(){var a="";if(this.checkInstall())try{var b=document.getElementById(this.settings.pgeId);1==this.osBrowser||3==this.osBrowser?a=b.GetNicPhAddr(1):2==this.osBrowser&&(b.package=0,a=b.output(11))}catch(c){a=""}else a="";return a},machineCPU:function(){var a="";if(this.checkInstall())try{var b=document.getElementById(this.settings.pgeId);1==this.osBrowser||3==this.osBrowser?a=b.GetNicPhAddr(2):2==this.osBrowser&&(b.package=0,a=b.output(10))}catch(c){a=""}else a="";return a},pwdSimple:function(){var a="";if(this.checkInstall())try{var b=document.getElementById(this.settings.pgeId);1==this.osBrowser||3==this.osBrowser?a=b.output44:2==this.osBrowser&&(a=b.output(13))}catch(c){a=""}else a="";return a},pwdValid:function(){var a="";if(this.checkInstall())try{var b=document.getElementById(this.settings.pgeId);1==this.osBrowser||3==this.osBrowser?b.output1&&(a=b.output5):2==this.osBrowser&&(a=b.output(5))}catch(c){a=1}else a=1;return a},pwdHash:function(){var a="";if(this.checkInstall())try{var b=document.getElementById(this.settings.pgeId);1==this.osBrowser||3==this.osBrowser?a=b.output2:2==this.osBrowser&&(a=b.output(2))}catch(c){a=0}else a=0;return a},pwdLength:function(){var a="";if(this.checkInstall())try{var b=document.getElementById(this.settings.pgeId);1==this.osBrowser||3==this.osBrowser?a=b.output3:2==this.osBrowser&&(a=b.output(3))}catch(c){a=0}else a=0;return a},pwdStrength:function(){var a=0;if(this.checkInstall())try{var b=document.getElementById(this.settings.pgeId);if(1==this.osBrowser||3==this.osBrowser)var c=b.output3,d=b.output4;else if(2==this.osBrowser)var c=b.output(3),d=b.output(4);a=0==c?0:1==d?1:2==d&&c>=6?2:3==d&&c>=6?3:0}catch(e){a=0}else a=0;return a},checkInstall:function(){try{if(1==this.osBrowser){new ActiveXObject("JDedit.JDeditCtrl.1")}else if(2==this.osBrowser){var b=new Array,c=navigator.plugins.JDedit.description;if(c.indexOf(":")>0){b=c.split(":");{b[1]}}else;}else{if(3!=this.osBrowser)return!1;{new ActiveXObject("JDeditX64.JDeditCtrl.1")}}}catch(e){return!1}return!0},getVersion:function(){var a="";try{if(1==this.osBrowser||3==this.osBrowser)var b=document.getElementById(this.settings.pgeId),a=b.output35;else if(2==this.osBrowser){var c=new Array,d=navigator.plugins.JDedit.description;if(d.indexOf(":")>0){c=d.split(":");var a=c[1]}}}catch(e){return""}return""!=a&&void 0!=a?a:""},setColor:function(){var a="";if(this.checkInstall())try{var b=document.getElementById(this.settings.pgeId);void 0!=this.settings.pgeBackColor&&""!=this.settings.pgeBackColor&&(b.BackColor=this.settings.pgeBackColor),void 0!=this.settings.pgeForeColor&&""!=this.settings.pgeForeColor&&(b.ForeColor=this.settings.pgeForeColor)}catch(c){a=""}else a=""},checkUpdate:function(){return void 0==this.getVersion()&&""==this.getVersion()?1:1==this.osBrowser?this.ConvertVersion(this.getVersion())<this.ConvertVersion(PGEdit_IE32_Version)&&1==PGEdit_Update?1:0:3==this.osBrowser?this.ConvertVersion(this.getVersion())<this.ConvertVersion(PGEdit_IE64_Version)&&1==PGEdit_Update?1:0:2==this.osBrowser?this.ConvertVersion(this.getVersion())<this.ConvertVersion(PGEdit_FF_VERSION)&&1==PGEdit_Update?1:0:void 0},ConvertVersion:function(a){if(""!=a){var b=a.split("."),c=parseInt(1e3*b[0])+parseInt(100*b[1])+parseInt(10*b[2])+parseInt(b[3]);return c}return""},setDownText:function(){void 0!=this.pgeVersion&&""!=this.pgeVersion&&(this.pgeDownText="\u8bf7\u70b9\u6b64\u5347\u7ea7\u63a7\u4ef6")},pgInitialize:function(){if(this.checkInstall()){(1==this.osBrowser||3==this.osBrowser)&&a("#"+this.settings.pgeId+"_pge").show();var b=document.getElementById(this.settings.pgeId);void 0!=this.settings.pgeBackColor&&""!=this.settings.pgeBackColor&&(b.BackColor=this.settings.pgeBackColor),void 0!=this.settings.pgeForeColor&&""!=this.settings.pgeForeColor&&(b.ForeColor=this.settings.pgeForeColor)}else(1==this.osBrowser||3==this.osBrowser)&&a("#"+this.settings.pgeId+"_down").show()}}})}(jQuery);